---
title: "Coursework Template â€” ChickWeight Workflow"
subtitle: "MSc Statistics"
author: "Seojeong Hong"
format:
  html:
    toc: true
    highlight: tango
    self-contained: true
    df-print: paged
  pdf: default
format-links: false
bibliography: "references.bib"
---


<style type="text/css">
h1{
  font-size: 24pt;
}
h2{
  font-size: 18pt;
}
body{
  font-size: 12pt;
}
</style>

```{r setup, include = FALSE, tidy=TRUE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
include_solutions <- TRUE
```
```{r setup2, include=FALSE, tidy=TRUE}
# Put any library imports and other preamble here.
require(rmarkdown)
require(knitr)
require(kableExtra)

library(dplyr)
library(ggplot2)

```

# 1. Introduction
This coursework adapts the penguins workflow to the **built-in 'ChickWeight' dataset** in R. 
It satisfies the checklist: at least one section, table, figure, subfigure, labelled references, at least one external citation, hidden/displayed code chunks, and rendering to both HTML and PDF.

We cite the ggplot2 reference for visualization and the R manual for the computing environment
[@wickham2016ggplot2; @R-base].

# 2. Data

The `ChickWeight` dataset contains repeated measurements of chick body weight under different diets over time.

```{r} 
#| label: data-load
# Load dataset and perform basic checks

data("ChickWeight", package = "datasets")
head(ChickWeight)
```

We summarize the sample size and mean/SD of weight by Diet and Time in Table @tbl-summary.

```{r}
#| label: tbl-summary
#| tbl-cap: "Summary statistics of ChickWeight by Diet and Time."
summary_tbl <- ChickWeight |>
  group_by(Diet, Time) |>
  summarise(n = n(),
            mean_wt = mean(weight),
            sd_wt   = sd(weight),
            .groups = "drop")
knitr::kable(head(summary_tbl, 12), align = "r")

```

# 3. Methods

We demonstrate a simple, reproducible pipeline:

1. **Preprocessing:** ensure factor types; basic validation.
2. **Visualisation:** (a) individual growth trajectories; (b) distribution by diet and mean trajectories (subfigures).  
3. **Modelling:** a basic linear model `weight ~ Time * Diet` for illustration (not a full mixed-effects analysis).  

```{r}
#| label: code-preprocess
#| code-fold: true
#| code-summary: "Show/Hide preprocessing code"
df <- ChickWeight |>
  dplyr::mutate(
    Diet = factor(Diet),
    Chick = factor(Chick)
  )
stopifnot(!any(is.na(df$weight)))

```

# 4. Results

## 4.1 Figure: Individual trajectories and diet means

@fig-trajectory shows individual chick growth curves over time (thin lines), with diet-specific mean trends overlaid (thick lines).

```{r}
#| label: fig-trajectory
#| fig-cap: "Chick growth trajectories over time, coloured by diet; bold lines show diet-specific means."
#| fig-width: 8
#| fig-height: 5
#| echo: false
library(ggplot2)
ggplot(df, aes(Time, weight, group = Chick, color = Diet)) +
  geom_line(alpha = 0.5) +
  stat_summary(aes(group = Diet), fun = mean, geom = "line", linewidth = 1.2) +
  labs(x = "Time (days)", y = "Weight (g)")
```

## 4.2 Figures with Subfigures

@fig-subplots compares (A) the weight distribution by diet and (B) the diet-specific mean trajectories across time.

```{r}
#| label: fig-subplots
#| fig-cap: "Diet-wise weight distributions (left) and mean growth trajectories (right)."
#| fig-subcap:
#|   - "Weight distribution by diet"
#|   - "Diet-specific mean trajectories"
#| layout-ncol: 2
#| fig-width: 8
#| fig-height: 4

p1 <- ggplot(df, aes(Diet, weight, fill = Diet)) +
  geom_violin(trim = FALSE) +
  geom_boxplot(width = 0.15, outlier.shape = NA) +
  labs(x = "Diet", y = "Weight (g)") +
  theme(legend.position = "none")

p2 <- df |>
  dplyr::group_by(Diet, Time) |>
  dplyr::summarise(mean_wt = mean(weight), .groups = "drop") |>
  ggplot(aes(Time, mean_wt, color = Diet)) +
  geom_line(linewidth = 1) +
  labs(x = "Time (days)", y = "Mean Weight (g)")

list(p1, p2)
```

## 4.3 Model Table

@tbl-model summarises the coefficients of a simple linear model with interaction between time and diet.
This is an illustrative baseline rather than a full repeated-measures/mixed-effects analysis.

```{r}
#| label: tbl-model
#| tbl-cap: "Linear model summary for `weight ~ Time * Diet`."
#| echo: false
fit <- lm(weight ~ Time * Diet, data = df)
coef_tbl <- broom::tidy(fit)
knitr::kable(coef_tbl, digits = 3)
```

# 5. Code Visibility Examples

Hidden code example (prints only the result):

```{r}
#| label: code-hidden-example
#| echo: false
median_wt <- median(df$weight)
cat(sprintf("Median weight (hidden code, output only): %.1f g", median_wt))
```

Shown code example (shows code + output):

```{r}
#| label: code-shown-example
#| echo: true
summary(df$weight)
```

# 6. Discussion

@fig-trajectory and @fig-subplots indicate clear increases in weight over time and diet-specific differences in both central tendency and distribution.  
@tbl-model suggests that both **Time** and **Diet**, as well as their interaction, contribute to explaining weight variations. A more rigorous treatment could employ mixed-effects models to account for within-chick correlation.


# References

::: {#refs}
:::
